{"ast":null,"code":"import axios from 'axios';\nexport default {\n  name: 'SettingsDialog',\n  props: {\n    visible: Boolean,\n    currentSettings: Object\n  },\n  data() {\n    return {\n      formData: {\n        username: '',\n        password: '',\n        avatar: '',\n        nickname: ''\n      },\n      saving: false\n    };\n  },\n  watch: {\n    visible(newVal) {\n      if (newVal && this.currentSettings) {\n        this.formData = {\n          ...this.currentSettings,\n          password: '' // 不显示原密码\n        };\n      }\n    }\n  },\n  methods: {\n    close() {\n      this.$emit('update:visible', false);\n    },\n    async saveSettings() {\n      if (!this.formData.username || !this.formData.nickname) {\n        alert('用户名和昵称不能为空');\n        return;\n      }\n      this.saving = true;\n      try {\n        const response = await axios.put('http://127.0.0.1:8080/api/user/update', {\n          ...this.formData,\n          // 如果密码为空，不发送密码字段\n          ...(this.formData.password ? {\n            password: this.formData.password\n          } : {})\n        });\n        if (response.data.code === 200) {\n          this.$emit('settings-updated', this.formData);\n          this.close();\n        }\n      } catch (error) {\n        console.error('更新设置失败:', error);\n        alert('更新设置失败，请重试');\n      } finally {\n        this.saving = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","name","props","visible","Boolean","currentSettings","Object","data","formData","username","password","avatar","nickname","saving","watch","newVal","methods","close","$emit","saveSettings","alert","response","put","code","error","console"],"sources":["src/components/SettingsDialog.vue"],"sourcesContent":["<template>\n  <div class=\"settings-dialog\" v-if=\"visible\">\n    <div class=\"dialog-overlay\" @click=\"close\"></div>\n    <div class=\"dialog-content\">\n      <div class=\"dialog-header\">\n        <h3>账户设置</h3>\n        <div class=\"close-button\" @click=\"close\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"\n            stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n          </svg>\n        </div>\n      </div>\n\n      <div class=\"dialog-body\">\n        <div class=\"form-group\">\n          <label>头像</label>\n          <div class=\"avatar-upload\">\n            <div class=\"avatar-preview\">\n              <img v-if=\"formData.avatar\" :src=\"formData.avatar\" alt=\"头像预览\">\n              <div v-else class=\"text-avatar\">{{ formData.nickname ? formData.nickname[0].toUpperCase() : 'U' }}</div>\n            </div>\n            <input type=\"text\" v-model=\"formData.avatar\" placeholder=\"请输入头像URL\">\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label>昵称</label>\n          <input type=\"text\" v-model=\"formData.nickname\" placeholder=\"请输入昵称\">\n        </div>\n\n        <div class=\"form-group\">\n          <label>用户名</label>\n          <input type=\"text\" v-model=\"formData.username\" placeholder=\"请输入用户名\">\n        </div>\n\n        <div class=\"form-group\">\n          <label>新密码</label>\n          <input type=\"password\" v-model=\"formData.password\" placeholder=\"不修改请留空\">\n        </div>\n      </div>\n\n      <div class=\"dialog-footer\">\n        <button class=\"cancel-button\" @click=\"close\">取消</button>\n        <button class=\"save-button\" @click=\"saveSettings\" :disabled=\"saving\">\n          {{ saving ? '保存中...' : '保存' }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n  name: 'SettingsDialog',\n  props: {\n    visible: Boolean,\n    currentSettings: Object\n  },\n  data() {\n    return {\n      formData: {\n        username: '',\n        password: '',\n        avatar: '',\n        nickname: ''\n      },\n      saving: false\n    }\n  },\n  watch: {\n    visible(newVal) {\n      if (newVal && this.currentSettings) {\n        this.formData = {\n          ...this.currentSettings,\n          password: '' // 不显示原密码\n        }\n      }\n    }\n  },\n  methods: {\n    close() {\n      this.$emit('update:visible', false)\n    },\n    async saveSettings() {\n      if (!this.formData.username || !this.formData.nickname) {\n        alert('用户名和昵称不能为空')\n        return\n      }\n\n      this.saving = true\n      try {\n        const response = await axios.put('http://127.0.0.1:8080/api/user/update', {\n          ...this.formData,\n          // 如果密码为空，不发送密码字段\n          ...(this.formData.password ? { password: this.formData.password } : {})\n        })\n\n        if (response.data.code === 200) {\n          this.$emit('settings-updated', this.formData)\n          this.close()\n        }\n      } catch (error) {\n        console.error('更新设置失败:', error)\n        alert('更新设置失败，请重试')\n      } finally {\n        this.saving = false\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.settings-dialog {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.dialog-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n\n.dialog-content {\n  position: relative;\n  width: 400px;\n  background: white;\n  border-radius: 12px;\n  padding: 20px;\n  z-index: 1001;\n}\n\n.dialog-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.dialog-header h3 {\n  margin: 0;\n  font-size: 1.2rem;\n  color: #333;\n}\n\n.close-button {\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.3s ease;\n}\n\n.close-button:hover {\n  background-color: #f5f5f5;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  color: #666;\n  font-size: 0.9rem;\n}\n\n.form-group input {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #ddd;\n  border-radius: 6px;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n}\n\n.form-group input:focus {\n  outline: none;\n  border-color: #764ba2;\n  box-shadow: 0 0 0 2px rgba(118, 75, 162, 0.1);\n}\n\n.avatar-upload {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.avatar-preview {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  overflow: hidden;\n  background-color: #f5f5f5;\n}\n\n.avatar-preview img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.text-avatar {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  font-size: 1.5rem;\n  font-weight: bold;\n}\n\n.dialog-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 30px;\n}\n\n.cancel-button, .save-button {\n  padding: 8px 20px;\n  border-radius: 6px;\n  border: none;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.cancel-button {\n  background-color: #f5f5f5;\n  color: #666;\n}\n\n.cancel-button:hover {\n  background-color: #eee;\n}\n\n.save-button {\n  background-color: #764ba2;\n  color: white;\n}\n\n.save-button:hover:not(:disabled) {\n  background-color: #663e92;\n}\n\n.save-button:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n</style> "],"mappings":"AAsDA,OAAAA,KAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACAC,OAAA,EAAAC,OAAA;IACAC,eAAA,EAAAC;EACA;EACAC,KAAA;IACA;MACAC,QAAA;QACAC,QAAA;QACAC,QAAA;QACAC,MAAA;QACAC,QAAA;MACA;MACAC,MAAA;IACA;EACA;EACAC,KAAA;IACAX,QAAAY,MAAA;MACA,IAAAA,MAAA,SAAAV,eAAA;QACA,KAAAG,QAAA;UACA,QAAAH,eAAA;UACAK,QAAA;QACA;MACA;IACA;EACA;EACAM,OAAA;IACAC,MAAA;MACA,KAAAC,KAAA;IACA;IACA,MAAAC,aAAA;MACA,UAAAX,QAAA,CAAAC,QAAA,UAAAD,QAAA,CAAAI,QAAA;QACAQ,KAAA;QACA;MACA;MAEA,KAAAP,MAAA;MACA;QACA,MAAAQ,QAAA,SAAArB,KAAA,CAAAsB,GAAA;UACA,QAAAd,QAAA;UACA;UACA,SAAAA,QAAA,CAAAE,QAAA;YAAAA,QAAA,OAAAF,QAAA,CAAAE;UAAA;QACA;QAEA,IAAAW,QAAA,CAAAd,IAAA,CAAAgB,IAAA;UACA,KAAAL,KAAA,0BAAAV,QAAA;UACA,KAAAS,KAAA;QACA;MACA,SAAAO,KAAA;QACAC,OAAA,CAAAD,KAAA,YAAAA,KAAA;QACAJ,KAAA;MACA;QACA,KAAAP,MAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}